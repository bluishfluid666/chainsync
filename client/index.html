<!doctype html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <link rel="icon" type="image/png" href="%VITE_APP_LOGO%" />
    <link rel="apple-touch-icon" href="%VITE_APP_LOGO%" />
    <title>ChainSync</title>
    <!-- Add Google Fonts here, example:
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    -->
  </head>
  <!-- ChainSync Visitor Tracking -->
  <script>
    (function() {
      // Configuration
      const TRACKING_API = 'https://chainsync-tracking.vercel.app';
      const TRACKING_ENABLED = true;

      if (!TRACKING_ENABLED) return;

      async function trackVisitor() {
        try {
          const response = await fetch(`${TRACKING_API}/api/track`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              page: window.location.pathname,
              referrer: document.referrer || null,
              userAgent: navigator.userAgent,
              timestamp: new Date().toISOString(),
            }),
            credentials: 'omit',
          });

          if (response.ok) {
            console.log('[ChainSync] Visitor tracked');
          }
        } catch (error) {
          // Silently fail - don't disrupt user experience
          console.debug('[ChainSync] Tracking failed:', error.message);
        }
      }

      // Track on page load
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', trackVisitor);
      } else {
        trackVisitor();
      }

      // Track on page navigation (for SPA)
      const originalPushState = window.history.pushState;
      window.history.pushState = function(...args) {
        originalPushState.apply(window.history, args);
        trackVisitor();
      };
    })();
  </script>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script
      defer
      src="%VITE_ANALYTICS_ENDPOINT%/umami"
      data-website-id="%VITE_ANALYTICS_WEBSITE_ID%"></script>
  </body>

</html>